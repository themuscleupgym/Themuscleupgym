<!-- user.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MuscleUP Gym - Member Dashboard</title>
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js';
    import { getAuth, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js';
    import { getFirestore, doc, getDoc, updateDoc, collection, addDoc } from 'https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js';
    const firebaseConfig = {/* same config as above */};
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    onAuthStateChanged(auth, async user => {
      if (!user) {
        window.location.href = 'index.html';  // not logged in
      } else {
        const uid = user.uid;
        // Fetch user profile
        const docRef = doc(db, 'users', uid);
        const docSnap = await getDoc(docRef);
        if (docSnap.exists()) {
          const data = docSnap.data();
          // Populate profile fields
          document.getElementById('profileName').innerText = data.name;
          document.getElementById('profileStart').innerText = data.startDate;
          document.getElementById('profileEnd').innerText = data.endDate;
          // etc.
        }
      }
    });
    // Functions to record workout, attendance, etc.
    async function addWorkout() {
      const exercise = document.getElementById('newWorkout').value;
      await addDoc(collection(db, 'users', auth.currentUser.uid, 'workouts'), {
        date: new Date().toLocaleDateString(), exercise
      });
      alert('Workout logged!');
    }
    async function markAttendance() {
      await addDoc(collection(db, 'users', auth.currentUser.uid, 'attendance'), {
        date: new Date().toLocaleDateString()
      });
      alert('Attendance recorded!');
    }
  </script>
</head>
<body>
  <h2>Member Dashboard</h2>
  <div id="profileSection">
    <p>Name: <span id="profileName"></span></p>
    <p>Member Since: <span id="profileStart"></span></p>
    <p>Expires On: <span id="profileEnd"></span></p>
    <!-- More profile info -->
  </div>
  <div id="paymentsSection">
    <button onclick="window.location.href='upi-payment-link'">Pay Now (UPI)</button>
    <p>Upload payment screenshot:</p>
    <input type="file" id="paymentScreenshot" accept="image/*">
    <button onclick="uploadPayment()">Submit</button>
  </div>
  <div id="workoutSection">
    <h3>Record a Workout</h3>
    <input id="newWorkout" type="text" placeholder="Describe workout">
    <button onclick="addWorkout()">Add Workout</button>
  </div>
  <div id="attendanceSection">
    <h3>Attendance</h3>
    <button onclick="markAttendance()">Mark Present Today</button>
  </div>
  <!-- List of past workouts and attendance (could be populated via JS) -->
</body>
</html>
